{% extends "_base.html" %}

{% block title %}My Children | PoopyFeed{% endblock title %}

{% block content %}
<div class="row justify-content-center">
  <div class="col-lg-8">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h1 class="h3 mb-0">
        <i class="fa-solid fa-children me-2 text-primary"></i>My Children
      </h1>
      <a href="{% url 'children:child_add' %}" class="btn btn-primary">
        <i class="fa-solid fa-plus me-1"></i>Add Child
      </a>
    </div>

    {% if children %}
      <div class="row g-3">
        {% for child in children %}
          <div class="col-md-6">
            <div class="card h-100">
              <div class="card-body">
                <h5 class="card-title mb-1">{{ child.name }}</h5>
                <p class="text-body-secondary mb-2">
                  <i class="fa-solid fa-cake-candles me-1"></i>
                  {{ child.date_of_birth }}
                  {% if child.gender %}
                    <span class="ms-2">
                      {% if child.gender == "M" %}
                        <i class="fa-solid fa-mars text-info"></i>
                      {% elif child.gender == "F" %}
                        <i class="fa-solid fa-venus text-danger"></i>
                      {% else %}
                        <i class="fa-solid fa-genderless text-secondary"></i>
                      {% endif %}
                    </span>
                  {% endif %}
                </p>
                <p class="text-body-secondary small mb-1">
                  <i class="fa-solid fa-poo me-1"></i>
                  {% if child.last_diaper_change %}
                    <time datetime="{{ child.last_diaper_change|date:'c' }}" class="relative-time">
                      {{ child.last_diaper_change|date:"M j, Y g:i A" }}
                    </time>
                  {% else %}
                    No diaper changes yet
                  {% endif %}
                </p>
                <p class="text-body-secondary small mb-0">
                  <i class="fa-solid fa-moon me-1"></i>
                  {% if child.last_nap %}
                    <time datetime="{{ child.last_nap|date:'c' }}" class="relative-time">
                      {{ child.last_nap|date:"M j, Y g:i A" }}
                    </time>
                  {% else %}
                    No naps yet
                  {% endif %}
                </p>
              </div>
              <div class="card-footer bg-transparent border-top-0">
                <a href="{% url 'children:child_edit' child.pk %}" class="btn btn-outline-secondary btn-sm">
                  <i class="fa-solid fa-pen me-1"></i>Edit
                </a>
                <a href="{% url 'children:diaper_list' child.pk %}" class="btn btn-outline-success btn-sm">
                  <i class="fa-solid fa-poo me-1"></i>Diapers
                </a>
                <a href="{% url 'children:nap_list' child.pk %}" class="btn btn-outline-primary btn-sm">
                  <i class="fa-solid fa-moon me-1"></i>Naps
                </a>
                <a href="{% url 'children:child_delete' child.pk %}" class="btn btn-outline-danger btn-sm">
                  <i class="fa-solid fa-trash me-1"></i>Delete
                </a>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="card">
        <div class="card-body text-center py-5">
          <i class="fa-solid fa-baby fa-3x text-body-secondary mb-3"></i>
          <h5 class="text-body-secondary">No children added yet</h5>
          <p class="text-body-secondary mb-3">Add your first child to start tracking.</p>
          <a href="{% url 'children:child_add' %}" class="btn btn-primary">
            <i class="fa-solid fa-plus me-1"></i>Add Child
          </a>
        </div>
      </div>
    {% endif %}
  </div>
</div>
{% endblock content %}

{% block extra_js %}
<script>
  document.querySelectorAll('.relative-time').forEach(function(el) {
    const date = dayjs(el.getAttribute('datetime'));
    el.textContent = date.fromNow();
  });
</script>
{% endblock extra_js %}
